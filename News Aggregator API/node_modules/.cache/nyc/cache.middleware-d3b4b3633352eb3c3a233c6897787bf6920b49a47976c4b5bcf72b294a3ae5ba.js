function cov_1lixmy2y0l(){var path="E:\\airtribe\\Projects\\Backend-projects\\News Aggregator API\\middlewares\\cache.middleware.js";var hash="25a40b19e223dc448a2ef2b1c4ad3e68221bd2a0";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\airtribe\\Projects\\Backend-projects\\News Aggregator API\\middlewares\\cache.middleware.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:14},end:{line:2,column:39}},"2":{start:{line:5,column:20},end:{line:8,column:2}},"3":{start:{line:10,column:19},end:{line:23,column:1}},"4":{start:{line:11,column:2},end:{line:13,column:3}},"5":{start:{line:12,column:4},end:{line:12,column:45}},"6":{start:{line:15,column:19},end:{line:15,column:62}},"7":{start:{line:17,column:29},end:{line:17,column:60}},"8":{start:{line:18,column:2},end:{line:20,column:3}},"9":{start:{line:19,column:4},end:{line:19,column:64}},"10":{start:{line:22,column:2},end:{line:22,column:9}},"11":{start:{line:25,column:0},end:{line:28,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:19},end:{line:10,column:20}},loc:{start:{line:10,column:45},end:{line:23,column:1}},line:10}},branchMap:{"0":{loc:{start:{line:11,column:2},end:{line:13,column:3}},type:"if",locations:[{start:{line:11,column:2},end:{line:13,column:3}},{start:{line:11,column:2},end:{line:13,column:3}}],line:11},"1":{loc:{start:{line:18,column:2},end:{line:20,column:3}},type:"if",locations:[{start:{line:18,column:2},end:{line:20,column:3}},{start:{line:18,column:2},end:{line:20,column:3}}],line:18}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},f:{"0":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"25a40b19e223dc448a2ef2b1c4ad3e68221bd2a0"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1lixmy2y0l=function(){return actualCoverage;};}return actualCoverage;}cov_1lixmy2y0l();const Redis=(cov_1lixmy2y0l().s[0]++,require("ioredis"));const utils=(cov_1lixmy2y0l().s[1]++,require("../utils/utils"));// Create a Redis client
const redisClient=(cov_1lixmy2y0l().s[2]++,new Redis({host:"localhost",// Redis server host
port:6379// Redis server port
}));cov_1lixmy2y0l().s[3]++;const redisCache=async(req,res,next)=>{cov_1lixmy2y0l().f[0]++;cov_1lixmy2y0l().s[4]++;if(!req.user){cov_1lixmy2y0l().b[0][0]++;cov_1lixmy2y0l().s[5]++;return res.status(401).send(req.message);}else{cov_1lixmy2y0l().b[0][1]++;}const cacheKey=(cov_1lixmy2y0l().s[6]++,req.user._id+":"+utils.generateURL(req));const cachedNewsArticles=(cov_1lixmy2y0l().s[7]++,await redisClient.get(cacheKey));cov_1lixmy2y0l().s[8]++;if(cachedNewsArticles){cov_1lixmy2y0l().b[1][0]++;cov_1lixmy2y0l().s[9]++;return res.status(200).send(JSON.parse(cachedNewsArticles));}else{cov_1lixmy2y0l().b[1][1]++;}cov_1lixmy2y0l().s[10]++;next();// If data is not cached, proceed to the next middleware or route handler
};cov_1lixmy2y0l().s[11]++;module.exports={redisCache,redisClient};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWxpeG15MnkwbCIsImFjdHVhbENvdmVyYWdlIiwiUmVkaXMiLCJzIiwicmVxdWlyZSIsInV0aWxzIiwicmVkaXNDbGllbnQiLCJob3N0IiwicG9ydCIsInJlZGlzQ2FjaGUiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZiIsInVzZXIiLCJiIiwic3RhdHVzIiwic2VuZCIsIm1lc3NhZ2UiLCJjYWNoZUtleSIsIl9pZCIsImdlbmVyYXRlVVJMIiwiY2FjaGVkTmV3c0FydGljbGVzIiwiZ2V0IiwiSlNPTiIsInBhcnNlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImNhY2hlLm1pZGRsZXdhcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUmVkaXMgPSByZXF1aXJlKFwiaW9yZWRpc1wiKTtcclxuY29uc3QgdXRpbHMgPSByZXF1aXJlKFwiLi4vdXRpbHMvdXRpbHNcIik7XHJcblxyXG4vLyBDcmVhdGUgYSBSZWRpcyBjbGllbnRcclxuY29uc3QgcmVkaXNDbGllbnQgPSBuZXcgUmVkaXMoe1xyXG4gIGhvc3Q6IFwibG9jYWxob3N0XCIsIC8vIFJlZGlzIHNlcnZlciBob3N0XHJcbiAgcG9ydDogNjM3OSwgLy8gUmVkaXMgc2VydmVyIHBvcnRcclxufSk7XHJcblxyXG5jb25zdCByZWRpc0NhY2hlID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgaWYgKCFyZXEudXNlcikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHJlcS5tZXNzYWdlKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGNhY2hlS2V5ID0gcmVxLnVzZXIuX2lkICsgXCI6XCIgKyB1dGlscy5nZW5lcmF0ZVVSTChyZXEpO1xyXG5cclxuICBjb25zdCBjYWNoZWROZXdzQXJ0aWNsZXMgPSBhd2FpdCByZWRpc0NsaWVudC5nZXQoY2FjaGVLZXkpO1xyXG4gIGlmIChjYWNoZWROZXdzQXJ0aWNsZXMpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZChKU09OLnBhcnNlKGNhY2hlZE5ld3NBcnRpY2xlcykpO1xyXG4gIH1cclxuXHJcbiAgbmV4dCgpOyAvLyBJZiBkYXRhIGlzIG5vdCBjYWNoZWQsIHByb2NlZWQgdG8gdGhlIG5leHQgbWlkZGxld2FyZSBvciByb3V0ZSBoYW5kbGVyXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICByZWRpc0NhY2hlLFxyXG4gIHJlZGlzQ2xpZW50LFxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiIyNkRBZVk7QUFBQUEsY0FBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxjQUFBLEdBZlosS0FBTSxDQUFBRSxLQUFLLEVBQUFGLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQ2hDLEtBQU0sQ0FBQUMsS0FBSyxFQUFBTCxjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLGdCQUFnQixDQUFDLEVBRXZDO0FBQ0EsS0FBTSxDQUFBRSxXQUFXLEVBQUFOLGNBQUEsR0FBQUcsQ0FBQSxNQUFHLEdBQUksQ0FBQUQsS0FBSyxDQUFDLENBQzVCSyxJQUFJLENBQUUsV0FBVyxDQUFFO0FBQ25CQyxJQUFJLENBQUUsSUFBTTtBQUNkLENBQUMsQ0FBQyxFQUFDUixjQUFBLEdBQUFHLENBQUEsTUFFSCxLQUFNLENBQUFNLFVBQVUsQ0FBRyxLQUFBQSxDQUFPQyxHQUFHLENBQUVDLEdBQUcsQ0FBRUMsSUFBSSxHQUFLLENBQUFaLGNBQUEsR0FBQWEsQ0FBQSxNQUFBYixjQUFBLEdBQUFHLENBQUEsTUFDM0MsR0FBSSxDQUFDTyxHQUFHLENBQUNJLElBQUksQ0FBRSxDQUFBZCxjQUFBLEdBQUFlLENBQUEsU0FBQWYsY0FBQSxHQUFBRyxDQUFBLE1BQ2IsTUFBTyxDQUFBUSxHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDUCxHQUFHLENBQUNRLE9BQU8sQ0FBQyxDQUMxQyxDQUFDLEtBQUFsQixjQUFBLEdBQUFlLENBQUEsVUFFRCxLQUFNLENBQUFJLFFBQVEsRUFBQW5CLGNBQUEsR0FBQUcsQ0FBQSxNQUFHTyxHQUFHLENBQUNJLElBQUksQ0FBQ00sR0FBRyxDQUFHLEdBQUcsQ0FBR2YsS0FBSyxDQUFDZ0IsV0FBVyxDQUFDWCxHQUFHLENBQUMsRUFFNUQsS0FBTSxDQUFBWSxrQkFBa0IsRUFBQXRCLGNBQUEsR0FBQUcsQ0FBQSxNQUFHLEtBQU0sQ0FBQUcsV0FBVyxDQUFDaUIsR0FBRyxDQUFDSixRQUFRLENBQUMsRUFBQ25CLGNBQUEsR0FBQUcsQ0FBQSxNQUMzRCxHQUFJbUIsa0JBQWtCLENBQUUsQ0FBQXRCLGNBQUEsR0FBQWUsQ0FBQSxTQUFBZixjQUFBLEdBQUFHLENBQUEsTUFDdEIsTUFBTyxDQUFBUSxHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDTyxJQUFJLENBQUNDLEtBQUssQ0FBQ0gsa0JBQWtCLENBQUMsQ0FBQyxDQUM3RCxDQUFDLEtBQUF0QixjQUFBLEdBQUFlLENBQUEsVUFBQWYsY0FBQSxHQUFBRyxDQUFBLE9BRURTLElBQUksQ0FBQyxDQUFDLENBQUU7QUFDVixDQUFDLENBQUNaLGNBQUEsR0FBQUcsQ0FBQSxPQUVGdUIsTUFBTSxDQUFDQyxPQUFPLENBQUcsQ0FDZmxCLFVBQVUsQ0FDVkgsV0FDRixDQUFDIn0=